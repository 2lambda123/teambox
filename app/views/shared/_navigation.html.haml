.separator.first
  Overview
.nav_links

  -# Recent Activity
  .el#activity_link= link_to t('.recent_activity'), '#!/', :class => 'recent_activity backboned'

  -# My Tasks
  .el#today_link= link_to t('.today'), '#!/today', :class => 'today backboned'
  .el#my_tasks_link= link_to t('.my_tasks'), '#!/my_tasks', :class => 'tasks backboned'
  .el#all_tasks_link= link_to t('.all_tasks'), '#!/all_tasks', :class => 'all_tasks backboned'
  .el= link_to t('.calendars'), calendars_path, :class => 'calendar ajax'

  -# All Projects
  - show_only_recent = current_user.people.size > 3
  - active_projects = current_user.projects.select{|p| !p.archived} #we select them in ruby because the query is done in the header already
  - projects_to_show = show_only_recent ? current_user.recent_projects : active_projects
  - projects_archived = current_user.people.size - projects_to_show.size

  .separator.with_margin Projects
  - for project in projects_to_show
    - next if project.new_record?
    .el= link_to project, project, :class => 'project'
    .contained
      .el{:id => "project_#{project.permalink}_activities"}= link_to t('.recent_activity'), "#!#{project_path(project)}", :class => 'recent_activity backboned'
      .el{:id => "project_#{project.permalink}_conversations"}= link_to t('.conversations'), "#!#{project_conversations_path(project)}", :class => 'conversations backbone'
      .el{:id => "project_#{project.permalink}_task_lists"}
        = link_to t('.tasks'), "#!#{project_task_lists_path(project)}", :class => 'tasks backboned'
      - if time_tracking_enabled? and project.tracks_time
        .el= link_to t('.time'), project_time_path(project), :class => 'time ajax'
      .el= link_to t('.pages'), project_pages_path(project), :class => 'pages ajax'
      .el= link_to t('.files'), project_uploads_path(project), :class => 'files ajax'
      - if can?(:update, project)
        .el= link_to t('.settings'), project_settings_path(project), :class => 'settings'
        .contained
          .el= link_to t('shared.project_settings_navigation.general'), project_settings_path(project.permalink), :class => 'general_settings ajax'
          .el= link_to t('shared.project_settings_navigation.deletion'), project_deletion_path(project.permalink, :sub_action => 'deletion'), :class => 'deletion ajax'
          - if project.owner?(current_user)
            .el= link_to t('shared.project_settings_navigation.ownership'), project_ownership_path(project.permalink, :sub_action => 'ownership'), :class => 'ownership ajax'
      - if can?(:admin, project)
        .el= link_to t('.people'), project_people_path(project), :class => 'people ajax'
  - if current_user.people.any?
    -# .el#projects_link= link_to t('.show_all_projects'), '#!/projects', :class => 'more'
  - if !Teambox.config.community || (Teambox.config.community && !@community_organization) || (@community_organization && @community_role)
    .el#new_project_link= link_to t('.new_project'), new_project_path, :class => 'more ajax'

  .separator.with_margin More...
  -# Organizations
  .el#my_organizations= link_to t('.organizations'), organizations_path, :class => 'people'
  .contained#my_organizations_list

  .el= link_to t('.time'), time_path, :class => 'ajax time'
  .el= link_to "Chat", "/chat", :class => 'chat'

