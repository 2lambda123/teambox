unless @avatar.x1.nil? || @avatar.y1.nil? || @avatar.crop_width.nil? || @avatar.crop_width.nil?
  @avatar.operate do |image|
    image.crop( 
      :from => [@avatar.x1,@avatar.y1].join('x'), 
      :size => [@avatar.crop_width,@avatar.crop_width].join('x')
    )
    image.resize '40x40'
  end
else
  @avatar.operate do |image|
    image.resize '40x40'
  end  
end