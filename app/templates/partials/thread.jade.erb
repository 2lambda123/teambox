.comment.comment_header
  span.time
    time.timeago(data-msec= self.ms(self.updated_at), pubdate= 'true')= self.updated_at

  .info
    img(src= '/famfamfam/' + (self.is_task ? 'tick' : 'comment') + '.png', style= 'padding: 4px')
    .comment_count
      span= self.comments_count

  .block
    .thread_title
      .lock_icon
      - if (self.is_task)
        a(href= self.task_url(self, self.project))= self.name + ' on'

        - if (self.task_list && self.project)
          a(href= self.task_list_url(self.task_list, self.project))= self.name + ' task list'
      - else
        a(href= self.conversation_url(self, self.project))= self.name ? self.name : '<%= t('conversations.untitled')%>'

    .project_overlay
      a(href= self.project_url(self.project), data-project-id= self.project.id)= self.project.name

    - if (self.is_task)
      .task_summary
        != self.status_transition()
        = 'Assigned to ' + self.full_name(self.user)

    - if (self.last_comment)
      p.excerpt
        strong= self.full_name(self.last_comment.user)
        = self.last_comment.body
  .clear
.comments
  - if (self.first_comment)
    != self.partial('partials.comment', self.first_comment)

  - if (self.hidden_comments_count)
    .more_comments
      a(href= '/activities/' + self.id + '/show_thread?thread_type=' + self.type)= 'Show ' + self.hidden_comments_count + ' previous comments'

  - each recent_comment in self.recent_comments
    != self.partial('partials.comment', recent_comment)
